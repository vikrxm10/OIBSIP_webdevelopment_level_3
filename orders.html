<!DOCTYPE html>

<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>My Orders - PizzaSlice</title>
<!-- Google Fonts: Plus Jakarta Sans & Noto Sans -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&amp;family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&amp;display=swap" rel="stylesheet"/>
<!-- Material Symbols -->
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<!-- Theme Configuration -->
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#f2590d",
                        "background-light": "#f8f6f5",
                        "background-dark": "#221610",
                        "text-main": "#1c120d",
                        "text-muted": "#9c6549",
                        "border-color": "#f4ebe7",
                    },
                    fontFamily: {
                        "display": ["Plus Jakarta Sans", "sans-serif"],
                        "body": ["Noto Sans", "sans-serif"],
                    },
                    borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
                },
            },
        }
    </script>
<style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
        }
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            vertical-align: middle;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-text-main">
<div class="relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden">
<!-- Top Navigation -->
<header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-border-color bg-white dark:bg-[#2a1d17] px-10 py-3 sticky top-0 z-50">
<div class="flex items-center gap-4 text-text-main dark:text-white">
<div class="size-8 text-primary">
<span class="material-symbols-outlined text-3xl">local_pizza</span>
</div>
<h2 class="text-text-main dark:text-white text-xl font-bold leading-tight tracking-[-0.015em]">PizzaSlice</h2>
</div>
<div class="flex flex-1 justify-end gap-8">
<div class="hidden md:flex items-center gap-9">
<a class="text-text-main dark:text-gray-200 text-sm font-medium leading-normal hover:text-primary transition-colors" href="menu.html">Menu</a>
<a class="text-text-main dark:text-gray-200 text-sm font-medium leading-normal hover:text-primary transition-colors" href="#">Deals</a>
<a class="text-primary text-sm font-bold leading-normal" href="orders.html">My Orders</a>
<a class="text-text-main dark:text-gray-200 text-sm font-medium leading-normal hover:text-primary transition-colors flex items-center gap-2" href="cart.html">
                        Cart
                        <span class="bg-primary text-white text-[10px] px-1.5 py-0.5 rounded-full">2</span>
</a>
</div>
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border-2 border-primary/20" data-alt="User profile avatar showing a smiling person" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDF6808VWk7XxhghVAAvojI5rFEOnYEaxvj6cF32NZ6KdPKGLILhXUWs_ktv2t6AihFAwiQYDzt39gjpwBrjxdNXDgM8rm5NzBCJ8kSAhLNpWTiU4npbt2lUZNKsdvZxpkWnTdvtxOsGDBoju-7JZTuu-XGaaoJHMhuHsVhjoqzmOEkGXBOVf4X67Qi6YhKMSPa5xwgo2bvVj3-tblKAYPYErglfr5D8TmkyxVzIznu18V2-QensAgwlC5GehBQsdmxG40AuPbWOGw");'></div>
</div>
</header>
<div class="layout-container flex h-full grow flex-col">
<div class="md:px-40 px-4 flex flex-1 justify-center py-8">
<div class="layout-content-container flex flex-col max-w-[960px] flex-1">
<!-- Page Heading -->
<div class="flex flex-wrap justify-between items-end gap-3 pb-6 border-b border-border-color">
<div>
<p class="text-text-main dark:text-white text-4xl font-black leading-tight tracking-[-0.033em]">My Orders</p>
<p class="text-text-muted mt-2 text-sm font-medium">Manage your order history and track active deliveries.</p>
</div>
<div class="flex gap-2">
<button class="flex items-center gap-2 px-4 py-2 bg-white dark:bg-[#2a1d17] border border-border-color rounded-lg text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
<span class="material-symbols-outlined text-[18px]">filter_list</span>
                                Filter
                            </button>
</div>
</div>
<!-- Tabs -->
<div class="pt-6 pb-2">
<div class="flex gap-8">
<a class="flex flex-col items-center justify-center border-b-[3px] border-primary pb-3 px-2 cursor-pointer transition-colors" href="#">
<p class="text-text-main dark:text-white text-sm font-bold leading-normal tracking-[0.015em]">Active Orders</p>
</a>
<a class="flex flex-col items-center justify-center border-b-[3px] border-transparent hover:border-border-color pb-3 px-2 cursor-pointer transition-colors" href="#">
<p class="text-text-muted hover:text-text-main dark:text-gray-400 dark:hover:text-white text-sm font-bold leading-normal tracking-[0.015em]">Order History</p>
</a>
<a class="flex flex-col items-center justify-center border-b-[3px] border-transparent hover:border-border-color pb-3 px-2 cursor-pointer transition-colors" href="#">
<p class="text-text-muted hover:text-text-main dark:text-gray-400 dark:hover:text-white text-sm font-bold leading-normal tracking-[0.015em]">Cancelled</p>
</a>
</div>
</div>
<!-- Active Order Section (Hero) -->
<div class="mt-8 mb-10">
<div class="flex items-center gap-2 mb-4">
<span class="relative flex h-3 w-3">
<span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>
<span class="relative inline-flex rounded-full h-3 w-3 bg-primary"></span>
</span>
<h2 class="text-text-main dark:text-white tracking-tight text-[22px] font-bold leading-tight">In Progress</h2>
</div>
<div id="activeOrderSection" class="flex flex-col md:flex-row items-stretch justify-between gap-6 rounded-xl bg-white dark:bg-[#2a1d17] p-6 shadow-[0_4px_20px_rgba(0,0,0,0.05)] border border-primary/20">
<!-- Order Info -->
<div class="flex flex-col justify-between flex-[2] gap-6">
<div>
<div class="flex justify-between items-start">
<div>
<div class="flex items-center gap-3 mb-1">
<p id="activeOrderId" class="text-text-main dark:text-white text-xl font-bold leading-tight">Order #29384</p>
<span id="activeOrderStatus" class="bg-primary/10 text-primary text-xs font-bold px-2 py-1 rounded-full border border-primary/20">Preparing</span>
</div>
<p class="text-text-muted text-sm font-medium">Today at 7:30 PM • Estimated Arrival: 8:15 PM</p>
</div>
<p id="activeOrderAmount" class="text-text-main dark:text-white text-xl font-bold">$32.50</p>
</div>
<div id="activeOrderItems" class="mt-4 space-y-1">
<p class="text-text-main dark:text-gray-300 text-sm font-medium flex items-center gap-2">
<span class="material-symbols-outlined text-[16px] text-primary">restaurant</span>
                                            1x Large Pepperoni Feast (Extra Cheese)
                                        </p>
<p class="text-text-main dark:text-gray-300 text-sm font-medium flex items-center gap-2">
<span class="material-symbols-outlined text-[16px] text-primary">bakery_dining</span>
                                            1x Garlic Knots (6 pcs)
                                        </p>
<p class="text-text-main dark:text-gray-300 text-sm font-medium flex items-center gap-2">
<span class="material-symbols-outlined text-[16px] text-primary">local_drink</span>
                                            2x Coke Zero
                                        </p>
</div>
</div>
<!-- Progress Tracker -->
<div class="w-full mt-2">
<div class="relative flex items-center justify-between w-full mb-2">
<div class="absolute left-0 top-1/2 -translate-y-1/2 w-full h-1 bg-gray-100 dark:bg-gray-700 rounded-full -z-10"></div>
<div class="absolute left-0 top-1/2 -translate-y-1/2 w-[35%] h-1 bg-primary rounded-full -z-10 transition-all duration-1000"></div>
<!-- Step 1 -->
<div class="flex flex-col items-center gap-2">
<div class="size-8 rounded-full bg-primary flex items-center justify-center text-white shadow-lg shadow-primary/30">
<span class="material-symbols-outlined text-[16px]">check</span>
</div>
<span class="text-[10px] font-bold text-primary uppercase tracking-wider">Confirmed</span>
</div>
<!-- Step 2 -->
<div class="flex flex-col items-center gap-2">
<div class="size-8 rounded-full bg-primary flex items-center justify-center text-white ring-4 ring-primary/20">
<span class="material-symbols-outlined text-[16px]">skillet</span>
</div>
<span class="text-[10px] font-bold text-primary uppercase tracking-wider">Preparing</span>
</div>
<!-- Step 3 -->
<div class="flex flex-col items-center gap-2">
<div class="size-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-400">
<span class="material-symbols-outlined text-[16px]">local_fire_department</span>
</div>
<span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider">Baking</span>
</div>
<!-- Step 4 -->
<div class="flex flex-col items-center gap-2">
<div class="size-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-400">
<span class="material-symbols-outlined text-[16px]">two_wheeler</span>
</div>
<span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider">Delivery</span>
</div>
</div>
</div>
<div class="flex gap-3 mt-2">
<button id="trackActive" class="flex-1 flex cursor-pointer items-center justify-center rounded-lg h-10 px-6 bg-primary hover:bg-[#d94a05] transition-colors text-white gap-2 text-sm font-bold shadow-lg shadow-primary/20">
                                        Track Live
                                        <span class="material-symbols-outlined text-[18px]">arrow_forward</span>
</button>
<button id="viewReceiptActive" class="flex cursor-pointer items-center justify-center rounded-lg h-10 px-4 bg-white dark:bg-transparent border border-gray-200 dark:border-gray-700 text-text-main dark:text-white hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors gap-2 text-sm font-bold">
                                        View Receipt
                                    </button>
</div>
</div>
<!-- Map Placeholder -->
<div class="hidden md:block w-full md:w-[320px] bg-center bg-no-repeat bg-cover rounded-lg relative overflow-hidden group" data-location="New York City Map View" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCeIb9pphrrmE0J60Pr69mgLnhgGG_fOKN5n05qG0PRkbbR344bTIh2h-ZxjkyxPHVLVRwFNdv3P9VxKDFosQ8-GEojqpBnpDbSItMkU2C7iCYnUpp4xHZ0_bOv_FEzsBPQ_caALjSIQEB49bGZfAzAWtoF7CL72Gu3Q9vfzRtZ4xvYt7Qdnc_ZPGK15D2rmQQ8g-3YvcD9zaDWaDCkUWyX5iCd4f23okmweh2sw1O70YWuwOX_J1cMSvACsuTCM0icfbjl056sq-M");'>
<div class="absolute inset-0 bg-black/10 group-hover:bg-black/20 transition-colors"></div>
<div class="absolute bottom-4 left-4 right-4 bg-white/90 backdrop-blur-sm p-3 rounded-lg shadow-sm">
<div class="flex items-center gap-3">
<div class="size-8 rounded-full bg-primary/20 flex items-center justify-center text-primary">
<span class="material-symbols-outlined text-[18px]">pedal_bike</span>
</div>
<div>
<p class="text-xs font-bold text-text-main">Driver: Mike R.</p>
<p class="text-[10px] text-text-muted">Arriving in 15 mins</p>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- Past Orders List -->
<div>
<h2 class="text-text-main dark:text-white tracking-tight text-[22px] font-bold leading-tight mb-6 px-1">Past Orders</h2>
<div class="flex flex-col gap-4">
<!-- Card 1 -->
<div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4 rounded-xl bg-white dark:bg-[#2a1d17] p-4 shadow-[0_2px_8px_rgba(0,0,0,0.04)] hover:shadow-[0_4px_12px_rgba(0,0,0,0.08)] transition-all border border-transparent hover:border-primary/20 group">
<div class="flex items-start gap-4 flex-1 w-full">
<div class="w-20 h-20 shrink-0 bg-center bg-no-repeat bg-cover rounded-lg bg-gray-100" data-alt="Pepperoni pizza with basil" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDhoMXHrZb1DTJl3ucENnaJSMpMCJYLg6mVjesUsFzH_zAmV6Se4NcapJ6hBk_FoTL6r-oUbMip50tNKwgt5MOK8VXmWGjEjDN7wPuPZwCL0GphYFPTcuEorTHUNb8fp-DG5iO92wvH4xz8n4UJxH0ApLCd6PVB8tiNWx5qcTMGcBXut36a2o8_MMvzzP434rP1Z3Cr7n5Bq3e8WpQ8wCtkxEeF43kR52mtHq-YiQhZ0t6jjVA9_Xx8vHk9FRiQGjLipt14WasC-wM");'></div>
<div class="flex flex-col gap-1 w-full">
<div class="flex justify-between w-full md:hidden">
<p class="text-text-main dark:text-white text-base font-bold">Order #28991</p>
<p class="text-text-main dark:text-white font-bold">$45.20</p>
</div>
<p class="text-text-main dark:text-white text-base font-bold hidden md:block group-hover:text-primary transition-colors">Order #28991</p>
<p class="text-text-muted text-xs font-normal">Oct 20, 2023 • 3 items</p>
<p class="text-text-main dark:text-gray-300 text-sm font-medium mt-1 line-clamp-1">2x Hawaiian Paradise, Cheesy Bread, 2L Coke</p>
<div class="flex items-center gap-2 mt-2 md:hidden">
<span class="inline-flex items-center gap-1 rounded-full bg-green-100 dark:bg-green-900/30 px-2 py-0.5 text-xs font-bold text-green-700 dark:text-green-400">
<span class="material-symbols-outlined text-[14px]">check_circle</span> Delivered
                                            </span>
</div>
</div>
</div>
<div class="hidden md:flex flex-col items-end gap-1 min-w-[120px] text-right">
<p class="text-text-main dark:text-white text-lg font-bold">$45.20</p>
<span class="inline-flex items-center gap-1 rounded-full bg-green-50 dark:bg-green-900/20 px-2.5 py-1 text-xs font-bold text-green-700 dark:text-green-400">
<span class="material-symbols-outlined text-[14px]">check_circle</span> Delivered
                                    </span>
</div>
<div class="w-full md:w-auto flex items-center gap-2 mt-2 md:mt-0 pt-3 md:pt-0 border-t md:border-0 border-gray-100 dark:border-gray-800">
<button class="flex-1 md:flex-none cursor-pointer items-center justify-center rounded-lg h-9 px-4 bg-primary/10 hover:bg-primary/20 text-primary gap-1.5 text-sm font-bold transition-colors">
<span class="material-symbols-outlined text-[18px]">refresh</span>
                                        Reorder
                                    </button>
<button aria-label="Order Details" class="cursor-pointer items-center justify-center rounded-lg size-9 flex text-text-muted hover:text-text-main hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
<span class="material-symbols-outlined">chevron_right</span>
</button>
</div>
</div>
<!-- Card 2 -->
<div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4 rounded-xl bg-white dark:bg-[#2a1d17] p-4 shadow-[0_2px_8px_rgba(0,0,0,0.04)] hover:shadow-[0_4px_12px_rgba(0,0,0,0.08)] transition-all border border-transparent hover:border-primary/20 group">
<div class="flex items-start gap-4 flex-1 w-full">
<div class="w-20 h-20 shrink-0 bg-center bg-no-repeat bg-cover rounded-lg bg-gray-100" data-alt="Vegetarian pizza slice top view" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDYbUZw5ImVIbqD6bRVvLOWOJXoJAljXbc2z6bWoh28oZtVxxFmQ7gIzJEtN1IqOEvNg3TfxnHXwl42piB2TmmM0EwRpjLThqaieXciI2t7AGQK6xX_CTFPyXMIRz-b0oYTIIWS-2TasPtqvuA3O7ZkSgn02Ud47fqANEzkQrXm8QzgdiUrQug0ceOgoc41G1_ouLEohS7uuihArS_GeqY8Ihn-0KWkX6sk-mKWEvPImQYW3DHe9NuzrQZ6rJCG_2mOdZ_D_sK7PII");'></div>
<div class="flex flex-col gap-1 w-full">
<div class="flex justify-between w-full md:hidden">
<p class="text-text-main dark:text-white text-base font-bold">Order #28440</p>
<p class="text-text-main dark:text-white font-bold">$24.00</p>
</div>
<p class="text-text-main dark:text-white text-base font-bold hidden md:block group-hover:text-primary transition-colors">Order #28440</p>
<p class="text-text-muted text-xs font-normal">Oct 12, 2023 • 2 items</p>
<p class="text-text-main dark:text-gray-300 text-sm font-medium mt-1 line-clamp-1">1x Veggie Delight, Brownie Box</p>
<div class="flex items-center gap-2 mt-2 md:hidden">
<span class="inline-flex items-center gap-1 rounded-full bg-green-100 dark:bg-green-900/30 px-2 py-0.5 text-xs font-bold text-green-700 dark:text-green-400">
<span class="material-symbols-outlined text-[14px]">check_circle</span> Delivered
                                            </span>
</div>
</div>
</div>
<div class="hidden md:flex flex-col items-end gap-1 min-w-[120px] text-right">
<p class="text-text-main dark:text-white text-lg font-bold">$24.00</p>
<span class="inline-flex items-center gap-1 rounded-full bg-green-50 dark:bg-green-900/20 px-2.5 py-1 text-xs font-bold text-green-700 dark:text-green-400">
<span class="material-symbols-outlined text-[14px]">check_circle</span> Delivered
                                    </span>
</div>
<div class="w-full md:w-auto flex items-center gap-2 mt-2 md:mt-0 pt-3 md:pt-0 border-t md:border-0 border-gray-100 dark:border-gray-800">
<button class="flex-1 md:flex-none cursor-pointer items-center justify-center rounded-lg h-9 px-4 bg-primary/10 hover:bg-primary/20 text-primary gap-1.5 text-sm font-bold transition-colors">
<span class="material-symbols-outlined text-[18px]">refresh</span>
                                        Reorder
                                    </button>
<button aria-label="Order Details" class="cursor-pointer items-center justify-center rounded-lg size-9 flex text-text-muted hover:text-text-main hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
<span class="material-symbols-outlined">chevron_right</span>
</button>
</div>
</div>
<!-- Card 3 (Cancelled) -->
<div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4 rounded-xl bg-white dark:bg-[#2a1d17] p-4 shadow-[0_2px_8px_rgba(0,0,0,0.04)] opacity-75 hover:opacity-100 transition-all border border-transparent hover:border-gray-200">
<div class="flex items-start gap-4 flex-1 w-full">
<div class="w-20 h-20 shrink-0 bg-center bg-no-repeat bg-cover rounded-lg bg-gray-100 grayscale" data-alt="Margherita pizza close up" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBlrXVsDZAunE85l26ttlmsduAHI1pLUop2Fc3iHm-RyZQHqmjlMrPwGnUH8jsYYlf_2vk8i7ypt759U2Pgrdvrrya1ukQyr0ufYTKwdB10sPyv2yh62FWMR2JJkJ3uoY8siPyQaCbD1j9_elUWyujtDyavMlokiX4zHxKfIs2qoM9SnUcz-huq5RAF7MKMTVU4jFOsrtEgRplzYUIhMld95DCg798blYsgQIx4sZahNI1o2pL8QY1azaOEWmFGpwQURq4_Hnlu9H8");'></div>
<div class="flex flex-col gap-1 w-full">
<div class="flex justify-between w-full md:hidden">
<p class="text-text-main dark:text-white text-base font-bold line-through text-gray-400">Order #28102</p>
<p class="text-text-main dark:text-white font-bold text-gray-400">$18.90</p>
</div>
<p class="text-text-main dark:text-white text-base font-bold hidden md:block text-gray-400">Order #28102</p>
<p class="text-text-muted text-xs font-normal">Sep 30, 2023 • 1 item</p>
<p class="text-text-main dark:text-gray-300 text-sm font-medium mt-1 line-clamp-1 text-gray-500">1x Meat Lovers</p>
<div class="flex items-center gap-2 mt-2 md:hidden">
<span class="inline-flex items-center gap-1 rounded-full bg-gray-100 dark:bg-gray-700 px-2 py-0.5 text-xs font-bold text-gray-500 dark:text-gray-300">
<span class="material-symbols-outlined text-[14px]">cancel</span> Cancelled
                                            </span>
</div>
</div>
</div>
<div class="hidden md:flex flex-col items-end gap-1 min-w-[120px] text-right">
<p class="text-text-main dark:text-white text-lg font-bold text-gray-400">$18.90</p>
<span class="inline-flex items-center gap-1 rounded-full bg-gray-100 dark:bg-gray-700 px-2.5 py-1 text-xs font-bold text-gray-500 dark:text-gray-300">
<span class="material-symbols-outlined text-[14px]">cancel</span> Cancelled
                                    </span>
</div>
<div class="w-full md:w-auto flex items-center gap-2 mt-2 md:mt-0 pt-3 md:pt-0 border-t md:border-0 border-gray-100 dark:border-gray-800">
<button class="flex-1 md:flex-none cursor-pointer items-center justify-center rounded-lg h-9 px-4 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-text-main dark:text-white gap-1.5 text-sm font-bold transition-colors">
<span class="material-symbols-outlined text-[18px]">refresh</span>
                                        Reorder
                                    </button>
<button aria-label="Order Details" class="cursor-pointer items-center justify-center rounded-lg size-9 flex text-text-muted hover:text-text-main hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
<span class="material-symbols-outlined">chevron_right</span>
</button>
</div>
</div>
</div>
<!-- Load More -->
<div class="flex justify-center mt-10">
<button class="text-text-muted hover:text-primary font-bold text-sm flex items-center gap-2 transition-colors">
                                Load older orders
                                <span class="material-symbols-outlined">expand_more</span>
</button>
</div>
</div>
</div>
</div>
</div>

<script>
(function(){
  function formatCurrency(n){ return '$'+Number(n).toFixed(2); }
  function getOrders(){ try{ return JSON.parse(localStorage.getItem('orders')||'[]'); }catch(e){ return []; } }
  function saveOrders(o){ try{ localStorage.setItem('orders', JSON.stringify(o)); }catch(e){} }
  function getLastOrder(){ try{ return JSON.parse(localStorage.getItem('lastOrder')||'null'); }catch(e){ return null; } }
  function saveLastOrder(o){ try{ localStorage.setItem('lastOrder', JSON.stringify(o)); }catch(e){} }
  function getCart(){ try{ return JSON.parse(localStorage.getItem('cart')||'[]'); }catch(e){ return []; } }
  function saveCart(c){ try{ localStorage.setItem('cart', JSON.stringify(c)); }catch(e){} }

  function renderActiveOrder(){
    const last = getLastOrder();
    const active = document.getElementById('activeOrderSection');
    if(!last){ if(active) active.style.display = 'none'; return; }
    if(active) active.style.display = 'flex';
    document.getElementById('activeOrderId').textContent = last.orderId || 'Order';
    document.getElementById('activeOrderStatus').textContent = last.status || 'Preparing';
    document.getElementById('activeOrderEta').textContent = last.eta || (last.date ? new Date(last.date).toLocaleString() : '');
    document.getElementById('activeOrderAmount').textContent = last.formattedAmount || formatCurrency(last.amount||0);
    const itemsContainer = document.getElementById('activeOrderItems');
    itemsContainer.innerHTML = '';
    (last.items||[]).forEach(it => {
      const p = document.createElement('p');
      p.className = 'text-text-main dark:text-gray-300 text-sm font-medium flex items-center gap-2';
      p.innerHTML = '<span class="material-symbols-outlined text-[16px] text-primary">restaurant</span>' + (it.qty||1) + 'x ' + (it.name||'Item');
      itemsContainer.appendChild(p);
    });
  }

  function renderPastOrders(){
    const list = document.getElementById('pastOrdersList');
    const orders = getOrders();
    list.innerHTML = '';
    if (!orders || !orders.length){
      list.innerHTML = '<div class="rounded-xl bg-white dark:bg-[#2a1d17] p-8 text-center text-text-muted">You have no past orders yet.</div>';
      return;
    }
    orders.forEach(order => {
      const card = document.createElement('div');
      card.className = 'flex flex-col md:flex-row items-start md:items-center justify-between gap-4 rounded-xl bg-white dark:bg-[#2a1d17] p-4 shadow-[0_2px_8px_rgba(0,0,0,0.04)] transition-all border border-transparent hover:border-primary/20 group';
      const img = (order.items && order.items[0] && order.items[0].image) ? `background-image: url('${order.items[0].image}')` : '';
      card.innerHTML = `
        <div class="flex items-start gap-4 flex-1 w-full">
          <div class="w-20 h-20 shrink-0 bg-center bg-no-repeat bg-cover rounded-lg bg-gray-100" style="${img}"></div>
          <div class="flex flex-col gap-1 w-full">
            <div class="flex justify-between w-full md:hidden">
              <p class="text-text-main dark:text-white text-base font-bold">${order.orderId||''}</p>
              <p class="text-text-main dark:text-white font-bold">${order.formattedAmount || formatCurrency(order.amount||0)}</p>
            </div>
            <p class="text-text-main dark:text-white text-base font-bold hidden md:block group-hover:text-primary transition-colors">${order.orderId||''}</p>
            <p class="text-text-muted text-xs font-normal">${order.date ? new Date(order.date).toLocaleDateString() : ''} • ${ (order.items||[]).length } items</p>
            <p class="text-text-main dark:text-gray-300 text-sm font-medium mt-1 line-clamp-1">${ (order.items||[]).slice(0,3).map(i=> (i.qty||1)+'x '+(i.name||'')).join(', ') }</p>
          </div>
        </div>
        <div class="hidden md:flex flex-col items-end gap-1 min-w-[120px] text-right">
          <p class="text-text-main dark:text-white text-lg font-bold">${order.formattedAmount || formatCurrency(order.amount||0)}</p>
          <span class="inline-flex items-center gap-1 rounded-full bg-green-50 dark:bg-green-900/20 px-2.5 py-1 text-xs font-bold text-green-700 dark:text-green-400">${order.status || 'Delivered'}</span>
        </div>
        <div class="w-full md:w-auto flex items-center gap-2 mt-2 md:mt-0 pt-3 md:pt-0 border-t md:border-0 border-gray-100 dark:border-gray-800">
          <button class="reorderBtn flex-1 md:flex-none cursor-pointer items-center justify-center rounded-lg h-9 px-4 bg-primary/10 hover:bg-primary/20 text-primary gap-1.5 text-sm font-bold transition-colors"><span class="material-symbols-outlined text-[18px]">refresh</span> Reorder</button>
          <button class="detailsBtn cursor-pointer items-center justify-center rounded-lg size-9 flex text-text-muted hover:text-text-main hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"><span class="material-symbols-outlined">chevron_right</span></button>
        </div>
      `;
      list.appendChild(card);
      // Reorder handler
      card.querySelector('.reorderBtn')?.addEventListener('click', function(){
        const cart = getCart();
        (order.items||[]).forEach(it=>{
          const found = cart.find(c=> c.name === it.name);
          if (found) found.qty = (found.qty||1) + (it.qty||1);
          else cart.push({ name: it.name, price: it.price || 0, qty: it.qty || 1 });
        });
        saveCart(cart);
        window.location.href = 'cart.html';
      });
      // Details handler
      card.querySelector('.detailsBtn')?.addEventListener('click', function(){
        saveLastOrder(order);
        window.location.href = 'orderconfirmation.html';
      });
    });
  }

  document.addEventListener('DOMContentLoaded', function(){
    const last = getLastOrder();
    const orders = getOrders();
    if (last && !orders.find(o=> o.orderId === last.orderId)){
      orders.unshift(last);
      saveOrders(orders);
    }
    // Ensure required dynamic IDs exist when page still contains static markup
    (function ensureDynamicIds(){
      try{
        const headerGroup = document.querySelector('#activeOrderSection .flex.justify-between.items-start > div');
        if (headerGroup){
          const p1 = headerGroup.querySelector('p');
          if (p1 && !document.getElementById('activeOrderId')) p1.id = 'activeOrderId';
          const span = headerGroup.querySelector('span');
          if (span && !document.getElementById('activeOrderStatus')) span.id = 'activeOrderStatus';
          const pAll = headerGroup.querySelectorAll('p');
          if (pAll && pAll[1] && !document.getElementById('activeOrderEta')) pAll[1].id = 'activeOrderEta';
        }
        const h = Array.from(document.querySelectorAll('h2')).find(x => x.textContent && x.textContent.trim().startsWith('Past Orders'));
        if (h && h.nextElementSibling && !document.getElementById('pastOrdersList')) h.nextElementSibling.id = 'pastOrdersList';
      }catch(e){}
    })();

    renderActiveOrder();
    renderPastOrders();

    document.getElementById('trackActive')?.addEventListener('click', function(){
      const last2 = getLastOrder();
      if (last2){
        window.location.href = 'orderconfirmation.html';
      } else {
        alert('No active order to track.');
      }
    });

    document.getElementById('viewReceiptActive')?.addEventListener('click', function(){
      const last2 = getLastOrder();
      if (!last2) return alert('No receipt available');
      const w = window.open('','_blank');
      const itemsHtml = (last2.items||[]).map(i=>`<li>${i.qty||1} x ${i.name} - ${i.price?formatCurrency(i.price):''}</li>`).join('');
      w.document.write(`<html><head><title>Receipt ${last2.orderId}</title></head><body><h1>Order ${last2.orderId}</h1><p>${last2.formattedAmount || formatCurrency(last2.amount||0)}</p><ul>${itemsHtml}</ul><button onclick="window.print()">Print</button></body></html>`);
      w.document.close();
    });

    // Fallback: attach handlers to any existing static "Reorder" buttons (non-dynamic cards)
    document.querySelectorAll('button').forEach(btn => {
      try {
        if (!btn.textContent || !btn.textContent.includes('Reorder')) return;
        if (btn.dataset.reorderAttached) return;
        btn.dataset.reorderAttached = '1';
        btn.addEventListener('click', function(){
          const card = btn.closest('.group') || btn.closest('div');
          if (!card) return;
          const itemsText = (card.querySelector('.line-clamp-1')?.textContent || '').split(',').map(s=>s.trim()).filter(Boolean);
          if (!itemsText.length) { alert('No items to reorder'); return; }
          const cart = getCart();
          itemsText.forEach(seg=>{
            const m = seg.match(/^([0-9]+)x\s*(.*)$/i);
            const qty = m ? parseInt(m[1],10) : 1;
            const name = m ? m[2].trim() : seg;
            const found = cart.find(c=> c.name === name);
            if (found) found.qty = (found.qty||1) + qty;
            else cart.push({ name, price: 0, qty });
          });
          saveCart(cart);
          window.location.href = 'cart.html';
        });
      } catch(e){}
    });
  });
})();
</script>
<script src="app.js"></script>
</body></html>